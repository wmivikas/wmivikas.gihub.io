<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Anonymous Feed</title>

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- React + ReactDOM CDN -->
<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

<!-- Babel JSX Support -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

</head>

<body class="bg-slate-100">

<div id="root"></div>

<script type="text/babel">

const { useState, useEffect } = React;

const UNIQUE_SYMBOLS = ['ðŸŒŸ','ðŸŽ­','ðŸŽ¨','ðŸŽª','ðŸŽ¯','ðŸŽ²','ðŸŽ¸','ðŸŽº','ðŸš€','ðŸš•','ðŸš—','ðŸš´','ðŸ†','ðŸ€','ðŸ–ï¸','ðŸï¸','ðŸŽ®'];

const REACTION_TYPES = [
  { label:'Up', emoji:'ðŸ‘'},
  { label:'Down', emoji:'ðŸ‘Ž'},
  { label:'Love', emoji:'â¤ï¸'},
  { label:'Star', emoji:'â­'},
  { label:'Fire', emoji:'ðŸ”¥'}
];

const SAMPLE_POSTS = [
"Just discovered an amazing new coffee shop downtown! â˜•",
"Why do we park in driveways and drive on parkways? ðŸ¤”",
"Learning to code is like learning a new language!",
"Sunset today was beautiful ðŸŒ…",
"Pineapple belongs on pizza ðŸ•"
];

function App(){
  const [posts,setPosts]=useState([]);
  const [newPostText,setNewPostText]=useState("");
  const [mySymbol,setMySymbol]=useState("");
  const [usedSymbols,setUsedSymbols]=useState(new Set());
  const [commentingOn,setCommentingOn]=useState(null);
  const [commentText,setCommentText]=useState("");

  useEffect(()=>{
    const symbol = getUniqueSymbol();
    setMySymbol(symbol);

    const initial = SAMPLE_POSTS.map((t,i)=>({
      id:Date.now()+i,
      text:t,
      symbol:getUniqueSymbol(),
      timestamp:Date.now()-Math.random()*3000000,
      reactions:{},
      comments:[]
    }));

    setPosts(initial);
  },[]);

  function getUniqueSymbol(){
    const free = UNIQUE_SYMBOLS.filter(s=>!usedSymbols.has(s));
    const chosen = free.length ? free[Math.floor(Math.random()*free.length)] :
      UNIQUE_SYMBOLS[Math.floor(Math.random()*UNIQUE_SYMBOLS.length)];
    setUsedSymbols(p=>new Set([...p,chosen]));
    return chosen;
  }

  function getTimeAgo(t){
    const s=Math.floor((Date.now()-t)/1000);
    if(s<60)return s+"s ago";
    const m=Math.floor(s/60);
    if(m<60)return m+"m ago";
    const h=Math.floor(m/60);
    return h+"h ago";
  }

  function createPost(){
    if(!newPostText.trim())return;
    const p={
      id:Date.now(),
      text:newPostText,
      symbol:mySymbol,
      timestamp:Date.now(),
      reactions:{},
      comments:[]
    };
    setPosts(prev=>[p,...prev]);
    setNewPostText("");
  }

  function addReaction(id,label){
    setPosts(prev=>prev.map(p=>{
      if(p.id===id){
        const r={...p.reactions};
        r[label]=(r[label]||0)+1;
        return {...p,reactions:r};
      }
      return p;
    }));
  }

  function addComment(id){
    if(!commentText.trim())return;
    setPosts(prev=>prev.map(p=>{
      if(p.id===id){
        return {...p,comments:[...p.comments,{
          id:Date.now(),
          text:commentText,
          symbol:mySymbol,
          timestamp:Date.now(),
          reactions:{}
        }]};
      }
      return p;
    }));
    setCommentText("");
    setCommentingOn(null);
  }

return (
<div className="min-h-screen">

  <div className="p-6 bg-white shadow">
    <h1 className="text-3xl font-bold text-indigo-600">Anonymous Feed</h1>
    <p className="text-gray-500">You are <span className="text-2xl">{mySymbol}</span></p>

    <textarea
      className="w-full border p-3 rounded mt-3"
      value={newPostText}
      onChange={e=>setNewPostText(e.target.value)}
      placeholder="Write something..."
    />

    <button onClick={createPost}
      className="mt-2 px-6 py-2 bg-indigo-500 text-white rounded">
      Post
    </button>
  </div>

  <div className="p-4 space-y-4 max-w-3xl mx-auto">

  {posts.map(post=>(
    <div key={post.id} className="bg-white p-4 rounded shadow">
      <div className="flex gap-3 items-center">
        <div className="text-3xl">{post.symbol}</div>
        <div>
          <b>Anonymous</b>
          <div className="text-gray-500 text-sm">{getTimeAgo(post.timestamp)}</div>
        </div>
      </div>

      <p className="mt-3 text-lg">{post.text}</p>

      <div className="mt-3 flex gap-2">
        {REACTION_TYPES.map(r=>(
          <button key={r.label}
            onClick={()=>addReaction(post.id,r.label)}
            className="px-2 py-1 bg-gray-100 rounded">
            {r.emoji} {post.reactions[r.label] || ""}
          </button>
        ))}
      </div>

      <button
        onClick={()=>setCommentingOn(commentingOn===post.id?null:post.id)}
        className="text-indigo-600 mt-2">
        ðŸ’¬ {post.comments.length} Comments
      </button>

      {commentingOn===post.id && (
        <div className="mt-2 flex gap-2">
          <input
            className="border p-2 flex-1 rounded"
            value={commentText}
            onChange={e=>setCommentText(e.target.value)}
          />
          <button
            onClick={()=>addComment(post.id)}
            className="bg-indigo-500 text-white px-3 rounded">
            Send
          </button>
        </div>
      )}

      {post.comments.map(c=>(
        <div key={c.id} className="mt-2 p-2 bg-gray-50 rounded">
          <b>{c.symbol}</b> â€” {c.text}
        </div>
      ))}

    </div>
  ))}

  </div>

</div>
);
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);

</script>

</body>
</html>
